{% extends "base.html" %}

{% block title %}Connect GitHub - {{ branding.site_name }}{% endblock %}
{% block header_title %}Connect GitHub{% endblock %}

{% block content %}
<div style="max-width: 600px; margin: 0 auto;">
    <div style="text-align: center; margin-bottom: var(--webops-space-2xl);">
        <div style="width: 64px; height: 64px; border-radius: var(--webops-border-radius-lg); background: linear-gradient(135deg, #24292e, #6e5494); display: flex; align-items: center; justify-content: center; margin: 0 auto var(--webops-space-lg);  box-shadow: 0 4px 12px rgba(36, 41, 46, 0.3);">
            <span class="material-icons" style="font-size: 36px; color: white;">code</span>
        </div>
        <h1 style="font-size: var(--webops-font-size-3xl); font-weight: var(--webops-font-weight-bold); color: var(--webops-color-text-primary); margin-bottom: var(--webops-space-sm);">
            Connect GitHub
        </h1>
        <p style="color: var(--webops-color-text-secondary);">
            Enter your GitHub Personal Access Token to enable private repository deployment
        </p>
    </div>

    <form method="post" style="background: var(--webops-color-bg-secondary); border: 1px solid rgba(0, 255, 136, 0.2); border-radius: var(--webops-border-radius-lg); padding: var(--webops-space-2xl);">
        {% csrf_token %}

        <div style="margin-bottom: var(--webops-space-xl);">
            <label for="token" style="display: block; margin-bottom: var(--webops-space-sm); font-weight: var(--webops-font-weight-medium); color: var(--webops-color-text-primary);">
                Personal Access Token <span style="color: var(--webops-color-error);">*</span>
            </label>
            <input type="password" id="token" name="token" required
                   style="width: 100%; padding: var(--webops-space-md); background: var(--webops-color-bg-primary); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: var(--webops-border-radius-md); color: var(--webops-color-text-primary); font-family: 'Courier New', monospace;"
                   placeholder="ghp_...">
            <small style="display: block; margin-top: var(--webops-space-xs); color: var(--webops-color-text-tertiary);">
                Generate a token at <a href="https://github.com/settings/tokens/new" target="_blank" style="color: var(--webops-color-primary);">github.com/settings/tokens/new</a>
            </small>
        </div>

        <div style="background: rgba(0, 170, 255, 0.1); border: 1px solid rgba(0, 170, 255, 0.3); border-radius: var(--webops-border-radius-md); padding: var(--webops-space-lg); margin-bottom: var(--webops-space-xl);">
            <div style="display: flex; gap: var(--webops-space-sm); align-items: flex-start;">
                <span class="material-icons" style="color: var(--webops-color-info); font-size: 20px;">info</span>
                <div>
                    <strong style="color: var(--webops-color-text-primary);">Required Token Permissions</strong>
                    <p style="margin-top: var(--webops-space-xs); color: var(--webops-color-text-secondary); font-size: var(--webops-font-size-sm); line-height: 1.6;">
                        When creating your Personal Access Token, select these scopes:
                    </p>
                    <ul style="margin: var(--webops-space-sm) 0 0 var(--webops-space-lg); color: var(--webops-color-text-secondary); font-size: var(--webops-font-size-sm);">
                        <li><code style="background: rgba(0, 255, 136, 0.1); padding: 2px 6px; border-radius: 4px;">repo</code> - Full control of private repositories</li>
                        <li><code style="background: rgba(0, 255, 136, 0.1); padding: 2px 6px; border-radius: 4px;">read:user</code> - Read user profile data</li>
                    </ul>
                    <p style="margin-top: var(--webops-space-md); color: var(--webops-color-text-secondary); font-size: var(--webops-font-size-sm);">
                        <strong>Note:</strong> Classic tokens or Fine-grained tokens with repository access both work.
                    </p>
                </div>
            </div>
        </div>

        <div style="background: rgba(255, 191, 0, 0.1); border: 1px solid rgba(255, 191, 0, 0.3); border-radius: var(--webops-border-radius-md); padding: var(--webops-space-lg); margin-bottom: var(--webops-space-xl);">
            <div style="display: flex; gap: var(--webops-space-sm); align-items: flex-start;">
                <span class="material-icons" style="color: var(--webops-color-warning); font-size: 20px;">security</span>
                <div>
                    <strong style="color: var(--webops-color-text-primary);">Security</strong>
                    <p style="margin-top: var(--webops-space-xs); color: var(--webops-color-text-secondary); font-size: var(--webops-font-size-sm); line-height: 1.6;">
                        Your token is encrypted using Fernet encryption before being stored in the database. It's only decrypted when needed to clone repositories.
                    </p>
                </div>
            </div>
        </div>

        <div style="display: flex; gap: var(--webops-space-md);">
            <a href="{% url 'integrations_dashboard' %}"
               style="flex: 1; text-align: center; padding: var(--webops-space-md); background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: var(--webops-border-radius-md); color: var(--webops-color-text-secondary); text-decoration: none; transition: all var(--webops-transition-fast);">
                Cancel
            </a>
            <button type="submit"
                    style="flex: 2; padding: var(--webops-space-md); background: var(--webops-color-primary); border: none; border-radius: var(--webops-border-radius-md); color: var(--webops-color-bg-primary); font-weight: var(--font-weight-semibold); cursor: pointer; transition: all var(--webops-transition-fast);">
                Connect GitHub
            </button>
        </div>
    </form>

    <div style="margin-top: var(--webops-space-xl); padding: var(--webops-space-lg); background: rgba(0, 255, 136, 0.05); border: 1px solid rgba(0, 255, 136, 0.2); border-radius: var(--webops-border-radius-md);">
        <h3 style="font-size: var(--webops-font-size-sm); font-weight: var(--font-weight-semibold); color: var(--webops-color-text-primary); margin-bottom: var(--webops-space-md);">
            Quick Setup Guide
        </h3>
        <ol style="margin: 0; padding-left: var(--webops-space-xl); color: var(--webops-color-text-secondary); font-size: var(--webops-font-size-sm); line-height: 1.8;">
            <li>Go to <a href="https://github.com/settings/tokens/new" target="_blank" style="color: var(--webops-color-primary);">GitHub Settings â†’ Personal Access Tokens</a></li>
            <li>Click <strong>"Generate new token (classic)"</strong></li>
            <li>Give your token a name (e.g., "WebOps Deployment")</li>
            <li>Select the <code style="background: rgba(0, 255, 136, 0.1); padding: 2px 6px; border-radius: 4px;">repo</code> scope</li>
            <li>Click <strong>"Generate token"</strong> at the bottom</li>
            <li>Copy your token and paste it above</li>
        </ol>
    </div>
</div>
{% endblock %}
