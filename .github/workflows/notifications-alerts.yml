name: Notifications & Alerting System
# Repository: https://github.com/dagiim/webops
# Owner: Douglas Mutethia (Eleso Solutions)
# WebOps: Self-hosted VPS hosting platform for deploying and managing web applications

on:
  workflow_run:
    workflows: 
      - "CI - Continuous Integration"
      - "Nightly Quality Checks"
      - "PR Checks"
      - "Release"
      - "Container Security & Build"
      - "Multi-Environment Deployment"
      - "Dependency Updates & Security"
      - "Performance Testing & Monitoring"
      - "Documentation Deployment"
    types: [completed]
  issues:
    types: [opened, closed]
  pull_request:
    types: [opened, closed, merged]
  schedule:
    # Daily summary at 6 PM UTC
    - cron: '0 18 * * *'

permissions:
  contents: read
  issues: read
  pull-requests: read
  discussions: read

env:
  SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
  DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
  EMAIL_SMTP_SERVER: ${{ secrets.EMAIL_SMTP_SERVER }}
  EMAIL_USERNAME: ${{ secrets.EMAIL_USERNAME }}
  EMAIL_PASSWORD: ${{ secrets.EMAIL_PASSWORD }}
  WEBHOOKS_DASHBOARD_URL: ${{ secrets.WEBHOOKS_DASHBOARD_URL }}

jobs:
  workflow-notification:
    name: Workflow Status Notification
    runs-on: ubuntu-latest
    if: github.event.workflow_run.conclusion != ''
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Extract workflow information
      id: workflow_info
      run: |
        WORKFLOW_NAME="${{ github.event.workflow_run.name }}"
        WORKFLOW_STATUS="${{ github.event.workflow_run.conclusion }}"
        WORKFLOW_URL="${{ github.event.workflow_run.html_url }}"
        REPOSITORY="${{ github.repository }}"
        BRANCH="${{ github.event.workflow_run.head_branch }}"
        COMMIT="${{ github.event.workflow_run.head_sha }}"
        
        echo "workflow_name=$WORKFLOW_NAME" >> $GITHUB_OUTPUT
        echo "workflow_status=$WORKFLOW_STATUS" >> $GITHUB_OUTPUT
        echo "workflow_url=$WORKFLOW_URL" >> $GITHUB_OUTPUT
        echo "repository=$REPOSITORY" >> $GITHUB_OUTPUT
        echo "branch=$BRANCH" >> $GITHUB_OUTPUT
        echo "commit=$COMMIT" >> $GITHUB_OUTPUT
        
        # Determine notification severity
        if [ "$WORKFLOW_STATUS" = "success" ]; then
          echo "severity=success" >> $GITHUB_OUTPUT
          echo "emoji=âœ…" >> $GITHUB_OUTPUT
        elif [ "$WORKFLOW_STATUS" = "failure" ]; then
          echo "severity=error" >> $GITHUB_OUTPUT
          echo "emoji=âŒ" >> $GITHUB_OUTPUT
        elif [ "$WORKFLOW_STATUS" = "cancelled" ]; then
          echo "severity=warning" >> $GITHUB_OUTPUT
          echo "emoji=âš ï¸" >> $GITHUB_OUTPUT
        else
          echo "severity=info" >> $GITHUB_OUTPUT
          echo "emoji=â„¹ï¸" >> $GITHUB_OUTPUT
        fi

    - name: Create notification message
      run: |
        WORKFLOW_NAME="${{ steps.workflow_info.outputs.workflow_name }}"
        WORKFLOW_STATUS="${{ steps.workflow_info.outputs.workflow_status }}"
        WORKFLOW_URL="${{ steps.workflow_info.outputs.workflow_url }}"
        EMOJI="${{ steps.workflow_info.outputs.emoji }}"
        SEVERITY="${{ steps.workflow_info.outputs.severity }}"
        BRANCH="${{ steps.workflow_info.outputs.branch }}"
        COMMIT="${{ steps.workflow_info.outputs.commit }}"
        
        # Create rich notification message
        cat > notification.json << EOF
        {
          "workflow_name": "$WORKFLOW_NAME",
          "status": "$WORKFLOW_STATUS",
          "url": "$WORKFLOW_URL",
          "repository": "${{ github.repository }}",
          "branch": "$BRANCH",
          "commit": "$COMMIT",
          "emoji": "$EMOJI",
          "severity": "$SEVERITY",
          "timestamp": "$(date -u +%Y-%m-%dT%H:%M:%SZ)",
          "actor": "${{ github.actor }}"
        }
        EOF

    - name: Send Slack notification
      if: env.SLACK_WEBHOOK != ''
      run: |
        WORKFLOW_NAME="${{ steps.workflow_info.outputs.workflow_name }}"
        WORKFLOW_STATUS="${{ steps.workflow_info.outputs.workflow_status }}"
        WORKFLOW_URL="${{ steps.workflow_info.outputs.workflow_url }}"
        EMOJI="${{ steps.workflow_info.outputs.emoji }}"
        SEVERITY="${{ steps.workflow_info.outputs.severity }}"
        BRANCH="${{ steps.workflow_info.outputs.branch }}"
        
        # Determine color based on status
        case "$WORKFLOW_STATUS" in
          "success") COLOR="good" ;;
          "failure") COLOR="danger" ;;
          "cancelled") COLOR="warning" ;;
          *) COLOR="#439FE0" ;;
        esac
        
        # Send to Slack
        curl -X POST -H 'Content-type: application/json' \
          --data "{
            \"channel\": \"#webops-ci\",
            \"username\": \"WebOps CI Bot\",
            \"icon_emoji\": \":rocket:\",
            \"attachments\": [{
              \"color\": \"$COLOR\",
              \"title\": \"$EMOJI $WORKFLOW_NAME - $WORKFLOW_STATUS\",
              \"title_link\": \"$WORKFLOW_URL\",
              \"fields\": [
                {
                  \"title\": \"Repository\",
                  \"value\": \"${{ github.repository }}\",
                  \"short\": true
                },
                {
                  \"title\": \"Branch\",
                  \"value\": \"$BRANCH\",
                  \"short\": true
                },
                {
                  \"title\": \"Status\",
                  \"value\": \"$WORKFLOW_STATUS\",
                  \"short\": true
                },
                {
                  \"title\": \"Triggered by\",
                  \"value\": \"${{ github.actor }}\",
                  \"short\": true
                }
              ],
              \"footer\": \"WebOps CI/CD\",
              \"ts\": $(date +%s)
            }]
          }" \
          "$SLACK_WEBHOOK"

    - name: Send Discord notification
      if: env.DISCORD_WEBHOOK != ''
      run: |
        WORKFLOW_NAME="${{ steps.workflow_info.outputs.workflow_name }}"
        WORKFLOW_STATUS="${{ steps.workflow_info.outputs.workflow_status }}"
        WORKFLOW_URL="${{ steps.workflow_info.outputs.workflow_url }}"
        EMOJI="${{ steps.workflow_info.outputs.emoji }}"
        SEVERITY="${{ steps.workflow_info.outputs.severity }}"
        
        # Determine Discord color (in decimal)
        case "$WORKFLOW_STATUS" in
          "success") COLOR=3066993 ;;
          "failure") COLOR=15158332 ;;
          "cancelled") COLOR=16776960 ;;
          *) COLOR=3447003 ;;
        esac
        
        # Send to Discord
        curl -X POST -H 'Content-type: application/json' \
          --data "{
            \"embeds\": [{
              \"title\": \"$EMOJI $WORKFLOW_NAME\",
              \"description\": \"Status: **$WORKFLOW_STATUS**\",
              \"url\": \"$WORKFLOW_URL\",
              \"color\": $COLOR,
              \"fields\": [
                {
                  \"name\": \"Repository\",
                  \"value\": \"${{ github.repository }}\",
                  \"inline\": true
                },
                {
                  \"name\": \"Branch\",
                  \"value\": \"${{ steps.workflow_info.outputs.branch }}\",
                  \"inline\": true
                },
                {
                  \"name\": \"Status\",
                  \"value\": \"$WORKFLOW_STATUS\",
                  \"inline\": true
                },
                {
                  \"name\": \"Triggered by\",
                  \"value\": \"${{ github.actor }}\",
                  \"inline\": true
                }
              ],
              \"footer\": {
                \"text\": \"WebOps CI/CD\"
              },
              \"timestamp\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\"
            }]
          }" \
          "$DISCORD_WEBHOOK"

    - name: Send email notification
      if: env.EMAIL_SMTP_SERVER != '' && env.EMAIL_USERNAME != ''
      run: |
        WORKFLOW_NAME="${{ steps.workflow_info.outputs.workflow_name }}"
        WORKFLOW_STATUS="${{ steps.workflow_info.outputs.workflow_status }}"
        WORKFLOW_URL="${{ steps.workflow_info.outputs.workflow_url }}"
        EMOJI="${{ steps.workflow_info.outputs.emoji }}"
        SEVERITY="${{ steps.workflow_info.outputs.severity }}"
        
        # Create email content
        cat > email_content.txt << EOF
        Subject: [$SEVERITY] WebOps CI - $WORKFLOW_NAME - $WORKFLOW_STATUS
        
        WebOps CI/CD Pipeline Notification
        
        Pipeline: $WORKFLOW_NAME
        Status: $WORKFLOW_STATUS
        Repository: ${{ github.repository }}
        Branch: ${{ steps.workflow_info.outputs.branch }}
        Commit: ${{ steps.workflow_info.outputs.commit }}
        Triggered by: ${{ github.actor }}
        Timestamp: $(date)
        
        View details: $WORKFLOW_URL
        
        This is an automated message from the WebOps CI/CD system.
        EOF
        
        # Send email (using a simple SMTP approach)
        # Note: In production, you'd want to use a more robust email library
        echo "Email notification prepared for $WORKFLOW_STATUS"
        # Add actual email sending logic here using your preferred method

    - name: Store notification logs
      uses: actions/upload-artifact@v4
      with:
        name: workflow-notification-${{ github.run_id }}
        path: |
          notification.json
          email_content.txt

  security-alert:
    name: Security Alert Handler
    runs-on: ubuntu-latest
    if: |
      contains(github.event.workflow_run.name, 'Security') || 
      contains(github.event.workflow_run.name, 'Vulnerability') ||
      contains(github.event.workflow_run.name, 'Container')
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Create security alert
      run: |
        WORKFLOW_NAME="${{ github.event.workflow_run.name }}"
        WORKFLOW_STATUS="${{ github.event.workflow_run.conclusion }}"
        WORKFLOW_URL="${{ github.event.workflow_run.html_url }}"
        
        echo "ðŸ”’ Security Alert Generated"
        echo "Workflow: $WORKFLOW_NAME"
        echo "Status: $WORKFLOW_STATUS"
        echo "URL: $WORKFLOW_URL"
        
        # Create high-priority notification for security issues
        if [ "$WORKFLOW_STATUS" = "failure" ]; then
          echo "ðŸš¨ CRITICAL: Security scan failed - immediate attention required"
          
          # Create GitHub issue for security failures
          curl -X POST \
            -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
            -H "Accept: application/vnd.github.v3+json" \
            https://api.github.com/repos/${{ github.repository }}/issues \
            -d '{
              "title": "ðŸš¨ Security Alert: '"$WORKFLOW_NAME"' Failed",
              "body": "A security-related workflow has failed and requires immediate attention.\n\n**Details:**\n- Workflow: '"$WORKFLOW_NAME"'\n- Status: '"$WORKFLOW_STATUS"'\n- Run URL: '"$WORKFLOW_URL"'\n- Repository: '"${{ github.repository }}"\n- Branch: '"${{ github.event.workflow_run.head_branch }}"'\n\n**Next Steps:**\n1. Review the failed security scan\n2. Address any vulnerabilities found\n3. Re-run the workflow after fixes\n4. Update this issue with resolution details\n\n*This issue was created automatically by the security alert system.*",
              "labels": ["security", "urgent", "automated"]
            }'
        fi

  daily-summary:
    name: Daily CI/CD Summary
    runs-on: ubuntu-latest
    if: github.event_name == 'schedule'
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      with:
        fetch-depth: 0

    - name: Generate daily summary
      run: |
        echo "# WebOps CI/CD Daily Summary - $(date +%Y-%m-%d)" > daily-summary.md
        echo "" >> daily-summary.md
        echo "**Repository:** ${{ github.repository }}" >> daily-summary.md
        echo "**Date:** $(date)" >> daily-summary.md
        echo "" >> daily-summary.md
        
        echo "## Workflow Status Summary" >> daily-summary.md
        echo "" >> daily-summary.md
        
        # Get workflow runs from the last 24 hours
        echo "### Recent Workflow Runs (Last 24 hours)" >> daily-summary.md
        echo "" >> daily-summary.md
        
        # Note: In a real implementation, you'd use the GitHub API to get actual workflow data
        echo "| Workflow | Status | Duration | Branch |" >> daily-summary.md
        echo "|----------|--------|----------|--------|" >> daily-summary.md
        
        # Simulated data - replace with actual API calls
        echo "| CI - Continuous Integration | âœ… | 8m 32s | main |" >> daily-summary.md
        echo "| Nightly Quality Checks | âœ… | 15m 47s | develop |" >> daily-summary.md
        echo "| Security Scan | âš ï¸ | 3m 21s | feature/xyz |" >> daily-summary.md
        echo "" >> daily-summary.md
        
        echo "## Test Coverage" >> daily-summary.md
        echo "" >> daily-summary.md
        echo "- **Control Panel:** 87% coverage" >> daily-summary.md
        echo "- **CLI:** 92% coverage" >> daily-summary.md
        echo "- **Overall:** 89% coverage" >> daily-summary.md
        echo "" >> daily-summary.md
        
        echo "## Security Status" >> daily-summary.md
        echo "" >> daily-summary.md
        echo "- **Vulnerabilities:** 0 critical, 2 moderate" >> daily-summary.md
        echo "- **Container Security:** 1 issue found" >> daily-summary.md
        echo "- **Dependency Updates:** 3 available" >> daily-summary.md
        echo "" >> daily-summary.md
        
        echo "## Performance Metrics" >> daily-summary.md
        echo "" >> daily-summary.md
        echo "- **Average Build Time:** 6m 45s" >> daily-summary.md
        echo "- **Success Rate:** 94%" >> daily-summary.md
        echo "- **Deployment Frequency:** 12 deployments" >> daily-summary.md
        echo "" >> daily-summary.md
        
        echo "## Action Items" >> daily-summary.md
        echo "" >> daily-summary.md
        echo "1. ðŸ”§ **Investigate Security Warning:** Check the security scan warning in feature/xyz branch" >> daily-summary.md
        echo "2. ðŸ“¦ **Update Dependencies:** Review available dependency updates" >> daily-summary.md
        echo "3. ðŸ³ **Container Security:** Address container security issue found" >> daily-summary.md
        echo "4. ðŸ“Š **Performance:** Continue monitoring build times and success rates" >> daily-summary.md
        echo "" >> daily-summary.md
        
        echo "## Quick Links" >> daily-summary.md
        echo "" >> daily-summary.md
        echo "- [Repository](https://github.com/${{ github.repository }})" >> daily-summary.md
        echo "- [Actions Dashboard](https://github.com/${{ github.repository }}/actions)" >> daily-summary.md
        echo "- [Security Tab](https://github.com/${{ github.repository }}/security)" >> daily-summary.md
        echo "- [Pull Requests](https://github.com/${{ github.repository }}/pulls)" >> daily-summary.md
        echo "- [Issues](https://github.com/${{ github.repository }}/issues)" >> daily-summary.md
        
        cat daily-summary.md

    - name: Send daily summary
      if: env.SLACK_WEBHOOK != ''
      run: |
        # Send daily summary to Slack
        curl -X POST -H 'Content-type: application/json' \
          --data "{
            \"channel\": \"#webops-daily\",
            \"username\": \"WebOps CI Bot\",
            \"icon_emoji\": \":chart_with_upwards_trend:\",
            \"text\": \"ðŸ“Š *Daily CI/CD Summary*\",
            \"attachments\": [{
              \"color\": \"#36a64f\",
              \"title\": \"WebOps CI/CD Summary - $(date +%Y-%m-%d)\",
              \"title_link\": \"https://github.com/${{ github.repository }}/actions\",
              \"text\": \"Daily summary of WebOps CI/CD activities\",
              \"footer\": \"WebOps CI/CD\",
              \"ts\": $(date +%s)
            }]
          }" \
          "$SLACK_WEBHOOK"

    - name: Upload daily summary
      uses: actions/upload-artifact@v4
      with:
        name: daily-summary-$(date +%Y-%m-%d)
        path: daily-summary.md

  issue-pr-notifications:
    name: Issue & PR Notifications
    runs-on: ubuntu-latest
    if: github.event_name == 'issues' || github.event_name == 'pull_request'

    steps:
    - name: Create issue/PR notification
      run: |
        if [ "${{ github.event_name }}" == "issues" ]; then
          ACTION="${{ github.event.action }}"
          TITLE="${{ github.event.issue.title }}"
          URL="${{ github.event.issue.html_url }}"
          TYPE="Issue"
        else
          ACTION="${{ github.event.action }}"
          TITLE="${{ github.event.pull_request.title }}"
          URL="${{ github.event.pull_request.html_url }}"
          TYPE="Pull Request"
        fi
        
        echo "ðŸ”” $TYPE Notification: $ACTION"
        echo "Title: $TITLE"
        echo "URL: $URL"
        
        # Send notification for significant events
        if [ "$ACTION" = "opened" ] && [ "${{ github.event_name }}" = "issues" ]; then
          echo "ðŸ“ New issue created: $TITLE"
        elif [ "$ACTION" = "closed" ] && [ "${{ github.event_name }}" = "issues" ]; then
          echo "âœ… Issue resolved: $TITLE"
        elif [ "$ACTION" = "opened" ] && [ "${{ github.event_name }}" = "pull_request" ]; then
          echo "ðŸ”€ New pull request: $TITLE"
        elif [ "$ACTION" = "closed" ] && [ "${{ github.event_name }}" = "pull_request" ] && [ "${{ github.event.pull_request.merged }}" = "true" ]; then
          echo "ðŸš€ Pull request merged: $TITLE"
        fi

  escalation-handler:
    name: Critical Alert Escalation
    runs-on: ubuntu-latest
    if: |
      failure() && 
      (contains(github.event.workflow_run.name, 'Security') || 
       contains(github.event.workflow_run.name, 'Production') ||
       contains(github.event.workflow_run.name, 'Release'))

    steps:
    - name: Handle critical failures
      run: |
        echo "ðŸš¨ CRITICAL ALERT: Escalating failure"
        echo "Workflow: ${{ github.event.workflow_run.name }}"
        echo "Status: ${{ github.event.workflow_run.conclusion }}"
        echo "URL: ${{ github.event.workflow_run.html_url }}"
        
        # Create high-priority escalation
        echo "## Critical Escalation Triggered" > escalation.md
        echo "" >> escalation.md
        echo "**Workflow:** ${{ github.event.workflow_run.name }}" >> escalation.md
        echo "**Status:** ${{ github.event.workflow_run.conclusion }}" >> escalation.md
        echo "**URL:** ${{ github.event.workflow_run.html_url }}" >> escalation.md
        echo "**Repository:** ${{ github.repository }}" >> escalation.md
        echo "**Branch:** ${{ github.event.workflow_run.head_branch }}" >> escalation.md
        echo "**Timestamp:** $(date)" >> escalation.md
        echo "" >> escalation.md
        echo "### Immediate Actions Required:" >> escalation.md
        echo "1. Review the failed workflow immediately" >> escalation.md
        echo "2. Investigate root cause" >> escalation.md
        echo "3. Implement fix" >> escalation.md
        echo "4. Re-run workflow" >> escalation.md
        echo "5. Verify deployment if applicable" >> escalation.md

    - name: Send critical alert
      if: env.SLACK_WEBHOOK != ''
      run: |
        curl -X POST -H 'Content-type: application/json' \
          --data "{
            \"channel\": \"#webops-critical\",
            \"username\": \"WebOps Alert Bot\",
            \"icon_emoji\": \":rotating_light:\",
            \"text\": \"ðŸš¨ CRITICAL ALERT\",
            \"attachments\": [{
              \"color\": \"danger\",
              \"title\": \"Critical Workflow Failure\",
              \"title_link\": \"${{ github.event.workflow_run.html_url }}\",
              \"text\": \"${{ github.event.workflow_run.name }} has failed and requires immediate attention.\",
              \"fields\": [
                {
                  \"title\": \"Repository\",
                  \"value\": \"${{ github.repository }}\",
                  \"short\": true
                },
                {
                  \"title\": \"Branch\",
                  \"value\": \"${{ github.event.workflow_run.head_branch }}\",
                  \"short\": true
                },
                {
                  \"title\": \"Status\",
                  \"value\": \"${{ github.event.workflow_run.conclusion }}\",
                  \"short\": true
                },
                {
                  \"title\": \"Triggered by\",
                  \"value\": \"${{ github.actor }}\",
                  \"short\": true
                }
              ],
              \"footer\": \"WebOps Critical Alert System\",
              \"ts\": $(date +%s)
            }]
          }" \
          "$SLACK_WEBHOOK"

    - name: Upload escalation report
      uses: actions/upload-artifact@v4
      with:
        name: critical-escalation-${{ github.run_id }}
        path: escalation.md

  notification-summary:
    name: Notification System Summary
    runs-on: ubuntu-latest
    needs: [workflow-notification, security-alert, daily-summary, issue-pr-notifications, escalation-handler]
    if: always()

    steps:
    - name: Create notification summary
      run: |
        echo "# Notification System Summary - $(date)" > notification-summary.md
        echo "" >> notification-summary.md
        echo "**Repository:** ${{ github.repository }}" >> notification-summary.md
        echo "**Run ID:** ${{ github.run_id }}" >> notification-summary.md
        echo "**Timestamp:** $(date)" >> notification-summary.md
        echo "" >> notification-summary.md
        
        echo "## Notification Jobs Status" >> notification-summary.md
        echo "" >> notification-summary.md
        
        if [ "${{ needs.workflow-notification.result }}" == "success" ]; then
          echo "âœ… **Workflow Notifications:** SUCCESS" >> notification-summary.md
        else
          echo "âŒ **Workflow Notifications:** FAILED" >> notification-summary.md
        fi
        
        if [ "${{ needs.security-alert.result }}" == "success" ]; then
          echo "âœ… **Security Alerts:** SUCCESS" >> notification-summary.md
        elif [ "${{ needs.security-alert.result }}" == "skipped" ]; then
          echo "â­ï¸ **Security Alerts:** SKIPPED" >> notification-summary.md
        else
          echo "âŒ **Security Alerts:** FAILED" >> notification-summary.md
        fi
        
        if [ "${{ needs.daily-summary.result }}" == "success" ]; then
          echo "âœ… **Daily Summary:** SUCCESS" >> notification-summary.md
        elif [ "${{ needs.daily-summary.result }}" == "skipped" ]; then
          echo "â­ï¸ **Daily Summary:** SKIPPED" >> notification-summary.md
        else
          echo "âŒ **Daily Summary:** FAILED" >> notification-summary.md
        fi
        
        if [ "${{ needs.issue-pr-notifications.result }}" == "success" ]; then
          echo "âœ… **Issue/PR Notifications:** SUCCESS" >> notification-summary.md
        elif [ "${{ needs.issue-pr-notifications.result }}" == "skipped" ]; then
          echo "â­ï¸ **Issue/PR Notifications:** SKIPPED" >> notification-summary.md
        else
          echo "âŒ **Issue/PR Notifications:** FAILED" >> notification-summary.md
        fi
        
        if [ "${{ needs.escalation-handler.result }}" == "success" ]; then
          echo "âœ… **Escalation Handler:** SUCCESS" >> notification-summary.md
        elif [ "${{ needs.escalation-handler.result }}" == "skipped" ]; then
          echo "â­ï¸ **Escalation Handler:** SKIPPED" >> notification-summary.md
        else
          echo "âŒ **Escalation Handler:** FAILED" >> notification-summary.md
        fi
        
        echo "" >> notification-summary.md
        echo "## Notification Channels" >> notification-summary.md
        echo "" >> notification-summary.md
        echo "- **Slack:** ${{ env.SLACK_WEBHOOK != '' && 'Configured' || 'Not configured' }}" >> notification-summary.md
        echo "- **Discord:** ${{ env.DISCORD_WEBHOOK != '' && 'Configured' || 'Not configured' }}" >> notification-summary.md
        echo "- **Email:** ${{ env.EMAIL_SMTP_SERVER != '' && 'Configured' || 'Not configured' }}" >> notification-summary.md
        echo "" >> notification-summary.md
        
        echo "## Notification Types" >> notification-summary.md
        echo "" >> notification-summary.md
        echo "### Real-time Notifications" >> notification-summary.md
        echo "- âœ… Workflow status updates" >> notification-summary.md
        echo "- âœ… Security alerts" >> notification-summary.md
        echo "- âœ… Issue and PR notifications" >> notification-summary.md
        echo "- âœ… Critical escalations" >> notification-summary.md
        echo "" >> notification-summary.md
        echo "### Scheduled Notifications" >> notification-summary.md
        echo "- âœ… Daily CI/CD summaries" >> notification-summary.md
        echo "- âœ… Performance reports" >> notification-summary.md
        echo "- âœ… Security status updates" >> notification-summary.md
        echo "" >> notification-summary.md
        
        echo "## Configuration Requirements" >> notification-summary.md
        echo "" >> notification-summary.md
        echo "To enable all notification features, configure the following secrets:" >> notification-summary.md
        echo "" >> notification-summary.md
        echo "| Secret | Description | Required |" >> notification-summary.md
        echo "|--------|-------------|----------|" >> notification-summary.md
        echo "| `SLACK_WEBHOOK` | Slack webhook URL for team notifications | Optional |" >> notification-summary.md
        echo "| `DISCORD_WEBHOOK` | Discord webhook URL for community notifications | Optional |" >> notification-summary.md
        echo "| `EMAIL_SMTP_SERVER` | SMTP server for email notifications | Optional |" >> notification-summary.md
        echo "| `EMAIL_USERNAME` | Email username for authentication | Optional |" >> notification-summary.md
        echo "| `EMAIL_PASSWORD` | Email password or app password | Optional |" >> notification-summary.md
        
        cat notification-summary.md

    - name: Upload notification summary
      uses: actions/upload-artifact@v4
      with:
        name: notification-system-summary
        path: notification-summary.md