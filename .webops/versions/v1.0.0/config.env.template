#
# WebOps Platform Configuration Template
# Copy this file to config.env and customize for your environment
#
# This file contains all configurable parameters for the WebOps platform
# Values can be overridden by environment variables
#

#=============================================================================
# Platform Configuration
#=============================================================================

# Platform version (do not modify unless upgrading)
WEBOPS_VERSION=v1.0.0

# Platform root directory
# Auto-detected from installation location or set explicitly
# Default: /opt/webops for production, detected path for development
WEBOPS_ROOT=${WEBOPS_ROOT:-/opt/webops}

# Platform data directory
WEBOPS_DATA_DIR=${WEBOPS_DATA_DIR:-${WEBOPS_ROOT}/data}

# Platform log directory
WEBOPS_LOG_DIR=${WEBOPS_LOG_DIR:-/var/log/webops}

# Platform backup directory
WEBOPS_BACKUP_DIR=${WEBOPS_BACKUP_DIR:-${WEBOPS_ROOT}/backups}

# Platform temporary directory
WEBOPS_TMP_DIR=${WEBOPS_TMP_DIR:-${WEBOPS_ROOT}/tmp}

# Control panel directory (Django application)
CONTROL_PANEL_DIR=${CONTROL_PANEL_DIR:-${WEBOPS_ROOT}/control-panel}

# Deployments directory
DEPLOYMENTS_DIR=${DEPLOYMENTS_DIR:-${WEBOPS_ROOT}/deployments}

# Shared files directory
SHARED_DIR=${SHARED_DIR:-${WEBOPS_ROOT}/shared}

#=============================================================================
# Security Configuration
#=============================================================================

# Encryption key for sensitive data (generate with: openssl rand -hex 32)
# IMPORTANT: Change this in production!
ENCRYPTION_KEY=change-this-encryption-key-in-production-32-chars

# JWT secret for API authentication (generate with: openssl rand -hex 32)
# IMPORTANT: Change this in production!
JWT_SECRET=change-this-jwt-secret-in-production-32-chars

# API token expiration (in hours)
API_TOKEN_EXPIRY=24

# Session timeout (in minutes)
SESSION_TIMEOUT=30

# Enable two-factor authentication
ENABLE_2FA=false

# Password policy requirements
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SYMBOLS=true

#=============================================================================
# SSH Security Configuration
#=============================================================================

# Enable/disable SSH hardening during installation
# Set to false to skip SSH configuration changes entirely
ENABLE_SSH_HARDENING=true

# Root login configuration:
#   no - Disable root login entirely (most secure, but can lock you out)
#   yes - Allow root login with password (least secure, not recommended)
#   prohibit-password - Allow root login with SSH keys only (recommended)
#   forced-commands-only - Root can only run specific commands
# IMPORTANT: If using "no", ensure you have another user with sudo access
PERMIT_ROOT_LOGIN=prohibit-password

# Password authentication configuration:
#   no - Disable password authentication, SSH keys only (recommended)
#   yes - Allow password authentication (less secure, but provides fallback)
# IMPORTANT: Set to "yes" if you don't have SSH keys configured
SSH_PASSWORD_AUTH=no

# Maximum authentication attempts before disconnect (default: 3)
# Helps prevent brute force attacks
SSH_MAX_AUTH_TRIES=3

#=============================================================================
# Database Configuration
#=============================================================================

# Database backend (sqlite, postgresql)
DATABASE_BACKEND=postgresql

# PostgreSQL configuration (if DATABASE_BACKEND=postgresql)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=webops
DB_USER=webops
DB_PASSWORD=change-this-database-password

# SQLite configuration (if DATABASE_BACKEND=sqlite)
SQLITE_DB_PATH=${WEBOPS_DATA_DIR}/webops.db

# Database connection pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30

#=============================================================================
# Redis Configuration
#=============================================================================

# Redis configuration for Celery and caching
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# Redis connection pool settings
REDIS_POOL_SIZE=50
REDIS_MAX_CONNECTIONS=100

#=============================================================================
# Control Panel Configuration
#=============================================================================

# Control panel settings
DEBUG=false
ALLOWED_HOSTS=localhost,127.0.0.1
SECRET_KEY=change-this-django-secret-key-in-production-50-chars-minimum

# Control panel port
CONTROL_PANEL_PORT=8009

# Control panel host
CONTROL_PANEL_HOST=0.0.0.0

# Enable SSL for control panel
CONTROL_PANEL_SSL=false

# SSL certificate paths (if SSL enabled)
SSL_CERT_PATH=/etc/ssl/certs/webops.crt
SSL_KEY_PATH=/etc/ssl/private/webops.key

#=============================================================================
# Deployment Configuration
#=============================================================================

# Port allocation for deployments
MIN_PORT=9000
MAX_PORT=9999

# Default deployment settings
DEFAULT_DEPLOYMENT_TIMEOUT=300
DEFAULT_HEALTH_CHECK_INTERVAL=30
DEFAULT_HEALTH_CHECK_TIMEOUT=10

# Deployment data directory
DEPLOYMENT_DATA_DIR=${WEBOPS_DATA_DIR}/deployments

# Deployment log directory
DEPLOYMENT_LOG_DIR=${WEBOPS_LOG_DIR}/deployments

# Maximum deployment size (in MB)
MAX_DEPLOYMENT_SIZE=1024

# Maximum number of deployments per user
MAX_DEPLOYMENTS_PER_USER=50

#=============================================================================
# PostgreSQL Addon Configuration
#=============================================================================

# PostgreSQL addon settings
POSTGRESQL_VERSION=15
POSTGRESQL_USER=postgres
POSTGRESQL_DATA_DIR=/var/lib/postgresql/data
POSTGRESQL_CONFIG_DIR=/etc/postgresql/15/main
POSTGRESQL_LOG_DIR=/var/log/postgresql

# PostgreSQL performance settings
POSTGRESQL_MAX_CONNECTIONS=200
POSTGRESQL_SHARED_BUFFERS=1GB
POSTGRESQL_EFFECTIVE_CACHE_SIZE=4GB
POSTGRESQL_WORK_MEM=16MB
POSTGRESQL_MAINTENANCE_WORK_MEM=128MB

# PostgreSQL backup settings
POSTGRESQL_BACKUP_ENABLED=true
POSTGRESQL_BACKUP_RETENTION_DAYS=7
POSTGRESQL_BACKUP_SCHEDULE="0 2 * * *"

#=============================================================================
# etcd Addon Configuration
#=============================================================================

# etcd addon settings
ETCD_VERSION=3.5.9
ETCD_USER=etcd
ETCD_DATA_DIR=/var/lib/etcd
ETCD_CONFIG_DIR=/etc/etcd
ETCD_LOG_DIR=/var/log/etcd
ETCD_CERT_DIR=/etc/etcd/certs

# etcd cluster settings
ETCD_CLUSTER_NAME=webops-cluster
ETCD_INITIAL_ADVERTISE_PEER_URLS=https://localhost:2380
ETCD_INITIAL_CLUSTER=etcd-1=https://localhost:2380
ETCD_INITIAL_CLUSTER_STATE=new

# etcd performance settings
ETCD_HEARTBEAT_INTERVAL=250
ETCD_ELECTION_TIMEOUT=5000
ETCD_MAX_SNAPSHOTS=5
ETCD_MAX_WALS=5

#=============================================================================
# Patroni Addon Configuration
#=============================================================================

# Patroni addon settings
PATRONI_VERSION=3.0.2
PATRONI_USER=patroni
PATRONI_CONFIG_DIR=/etc/patroni
PATRONI_LOG_DIR=/var/log/patroni
PATRONI_RUN_DIR=/var/run/patroni
PATRONI_DATA_DIR=/var/lib/postgresql/data

# Patroni cluster settings
PATRONI_CLUSTER_NAME=webops-pg-cluster
PATRONI_NAMESPACE=/service/
PATRONI_RESTAPI_PORT=8008
PATRONI_POSTGRESQL_PORT=5432

# PgBouncer settings
PGBOUNCER_USER=pgbouncer
PGBOUNCER_CONFIG_DIR=/etc/pgbouncer
PGBOUNCER_PORT=6432
PGBOUNCER_POOL_MODE=transaction
PGBOUNCER_MAX_CLIENT_CONN=1000
PGBOUNCER_DEFAULT_POOL_SIZE=20

#=============================================================================
# Monitoring Addon Configuration
#=============================================================================

# Monitoring addon settings
PROMETHEUS_VERSION=2.45.0
GRAFANA_VERSION=10.0.0
NODE_EXPORTER_VERSION=1.6.0
ALERTMANAGER_VERSION=0.25.0

# Monitoring users
PROMETHEUS_USER=prometheus
GRAFANA_USER=grafana

# Monitoring directories
MONITORING_DIR=/opt/monitoring
PROMETHEUS_DATA_DIR=/var/lib/prometheus
GRAFANA_DATA_DIR=/var/lib/grafana
ALERTMANAGER_DATA_DIR=/var/lib/alertmanager

# Monitoring ports
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000
NODE_EXPORTER_PORT=9100
ALERTMANAGER_PORT=9093

# Monitoring retention settings
PROMETHEUS_RETENTION=30d
ALERTMANAGER_RETENTION=120h

#=============================================================================
# Kubernetes Addon Configuration
#=============================================================================

# Kubernetes addon settings
KUBERNETES_VERSION=1.28.0
CONTAINERD_VERSION=1.7.0

# Kubernetes networking
POD_NETWORK_CIDR=10.244.0.0/16
SERVICE_SUBNET=10.96.0.0/12

# Kubernetes cluster settings
KUBEADM_TOKEN_TTL=24h
KUBEADM_TOKEN_EXPIRATION=0
KUBEADM_TOKEN_EXPIRATION=0

#=============================================================================
# KVM Addon Configuration
#=============================================================================

# KVM addon settings
KVM_USER=libvirt-qemu
LIBVIRT_GROUP=libvirt
BRIDGE_NAME=virbr0
BRIDGE_NETWORK=192.168.122.0/24
STORAGE_POOL=default
STORAGE_PATH=/var/lib/libvirt/images

# KVM performance settings
KVM_MAX_VCPUS=8
KVM_MAX_MEMORY=16384
KVM_DEFAULT_DISK_SIZE=20

#=============================================================================
# Email Configuration
#=============================================================================

# Email settings for notifications
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_HOST_USER=your-email@gmail.com
EMAIL_HOST_PASSWORD=your-app-password
EMAIL_USE_TLS=true
EMAIL_USE_SSL=false

# Default email addresses
DEFAULT_FROM_EMAIL=noreply@webops.local
ADMIN_EMAIL=admin@webops.local

#=============================================================================
# SSL/TLS Configuration
#=============================================================================

# Let's Encrypt settings
LETSENCRYPT_EMAIL=admin@webops.local
LETSENCRYPT_STAGING=false
LETSENCRYPT_RENEWAL=true
LETSENCRYPT_RENEWAL_DAYS=30

# SSL certificate paths
SSL_CERT_DIR=/etc/ssl/certs
SSL_KEY_DIR=/etc/ssl/private
SSL_CHAIN_DIR=/etc/ssl/certs

#=============================================================================
# Logging Configuration
#=============================================================================

# Log levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log formats
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_DATE_FORMAT=%Y-%m-%d %H:%M:%S

# Log rotation settings
LOG_MAX_SIZE=100MB
LOG_BACKUP_COUNT=10
LOG_ROTATION=daily

# Application loggers
LOGGERS=root,webops,celery,django

#=============================================================================
# Performance Configuration
#=============================================================================

# Cache settings
CACHE_BACKEND=redis
CACHE_TIMEOUT=300
CACHE_KEY_PREFIX=webops

# Session settings
SESSION_ENGINE=redis
SESSION_COOKIE_AGE=1800
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Lax

# Rate limiting
RATELIMIT_ENABLE=true
RATELIMIT_USE_CACHE=redis
RATELIMIT_DEFAULT=100/h

#=============================================================================
# Security Configuration
#=============================================================================

# CORS settings
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000
CORS_ALLOW_CREDENTIALS=true

# CSRF settings
CSRF_TRUSTED_ORIGINS=http://localhost:8009,http://127.0.0.1:8009
CSRF_COOKIE_SECURE=true
CSRF_COOKIE_HTTPONLY=true

# Content Security Policy
CSP_ENABLE=true
CSP_DEFAULT_SRC="'self'"
CSP_SCRIPT_SRC="'self' 'unsafe-inline'"
CSP_STYLE_SRC="'self' 'unsafe-inline'"

# File upload settings
MAX_UPLOAD_SIZE=100MB
ALLOWED_UPLOAD_EXTENSIONS=.txt,.log,.json,.yaml,.yml,.zip,.tar.gz

#=============================================================================
# Backup Configuration
#=============================================================================

# Backup settings
BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=30
BACKUP_SCHEDULE="0 3 * * *"
BACKUP_COMPRESSION=true
BACKUP_ENCRYPTION=true

# Backup destinations
BACKUP_LOCAL_PATH=${WEBOPS_BACKUP_DIR}
BACKUP_S3_BUCKET=
BACKUP_S3_REGION=
BACKUP_S3_ACCESS_KEY=
BACKUP_S3_SECRET_KEY=

#=============================================================================
# Monitoring and Alerting
#=============================================================================

# Health check settings
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=60
HEALTH_CHECK_TIMEOUT=10

# Alerting settings
ALERT_EMAIL_ENABLED=true
ALERT_SLACK_ENABLED=false
ALERT_SLACK_WEBHOOK=
ALERT_SLACK_CHANNEL=#alerts

# Metrics settings
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

#=============================================================================
# Development Configuration
#=============================================================================

# Development settings (only for development)
DEV_MODE=false
DEV_RELOAD=true
DEV_DEBUG_TOOLBAR=false
DEV_DEBUG_SQL=false

# Testing settings
TEST_DATABASE=webops_test
TEST_PARALLEL=true
TEST_KEEPDB=false

#=============================================================================
# Feature Flags
#=============================================================================

# Feature toggles
FEATURE_AUTOMATION=true
FEATURE_LLM_DEPLOYMENT=true
FEATURE_KUBERNETES=true
FEATURE_MONITORING=true
FEATURE_BACKUP=true
FEATURE_WEBHOOKS=true

# Beta features
BETA_FEATURE_MULTI_TENANT=false
BETA_FEATURE_ADVANCED_MONITORING=false
BETA_FEATURE_GPU_ACCELERATION=false

#=============================================================================
# Third-party Integrations
#=============================================================================

# GitHub integration (for Git deployments)
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
GITHUB_WEBHOOK_SECRET=

# Docker registry integration
DOCKER_REGISTRY_URL=
DOCKER_REGISTRY_USERNAME=
DOCKER_REGISTRY_PASSWORD=

# Cloud provider integrations
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1

DIGITALOCEAN_TOKEN=
VULTR_API_KEY=

#=============================================================================
# Custom Configuration
#=============================================================================

# Add your custom configuration variables here
# CUSTOM_VAR=value

# Custom addon configuration
# CUSTOM_ADDON_SETTING=value

#=============================================================================
# Auto-Recovery Addon Configuration
#=============================================================================

# Auto-recovery addon settings
INSTALL_AUTORECOVERY=false
AUTORECOVERY_ENABLED=false
AUTORECOVERY_CHECK_INTERVAL=30
AUTORECOVERY_MAX_RETRIES=3
AUTORECOVERY_RETRY_DELAY=60
AUTORECOVERY_CIRCUIT_BREAKER_THRESHOLD=5
AUTORECOVERY_CIRCUIT_BREAKER_TIMEOUT=300

# Auto-recovery notification settings
AUTORECOVERY_NOTIFICATIONS_ENABLED=true
AUTORECOVERY_WEBHOOK_URL=
AUTORECOVERY_LOG_LEVEL=INFO

#=============================================================================
# Environment-specific Overrides
#=============================================================================

# Production overrides
if [[ "$WEBOPS_ENV" == "production" ]]; then
    DEBUG=false
    LOG_LEVEL=WARNING
    SESSION_COOKIE_SECURE=true
    CSRF_COOKIE_SECURE=true
    HSTS_ENABLED=true
fi

# Development overrides
if [[ "$WEBOPS_ENV" == "development" ]]; then
    DEBUG=true
    LOG_LEVEL=DEBUG
    DEV_MODE=true
    EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend
fi

# Testing overrides
if [[ "$WEBOPS_ENV" == "testing" ]]; then
    DEBUG=false
    LOG_LEVEL=ERROR
    DATABASE_BACKEND=sqlite
    EMAIL_BACKEND=django.core.mail.backends.locmem.EmailBackend
fi